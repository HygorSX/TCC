<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Skooterz</title>
    <link rel="stylesheet" href="../css/style_buy.css">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/produtos.css">
    <link rel="stylesheet" href="../css/footer.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/remixicon@3.2.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/boxicons@latest/css/boxicons.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
</head>
<body onload="updateUserUI()">
    <header> 
        <a href="/" class="logo"><i class="ri-ancient-gate-fill"></i><span>Skooterz</span>
    </a>
        </a>
        </section>
        <ul class="navbar">
            
            <li><a href="/shape">Shapes </a>
            <li><a href="/skate">Skates </a>
            <li><a href="/roupas">Roupas </a>
            <li><a href="/acessorios">Acessórios</a>
            <li><a href="/tenis">Tenis</a>
            
        </ul><!--Cabecalho-Link-->
        <section class="main">
            <a href="#" class="user" id="user">
                <i class="ri-user-3-fill"></i> Faça seu login <br>ou registre-se
            </a>
            <section class="bx bx-menu" id="menu-icon"></section>
            <section class="search-box">
                <input type="text" class="search-txt" placeholder="Pesquisar">
                <a href="#" class="search-btn">
                    <img src="../imagens/001-loupe.png" alt="Lupa" height="20" width="20">
                </a>
            </section>
            <section id="user-dropdown" class="dropdown hidden">
                <a onclick="logoutUser()" id="logout"><i class="fa-solid fa-right-from-bracket" style="color: #ff0000;"></i>ㅤLogout</a>
            </section>
        </section>
    
    </header>


    <main>
        <section>
            <section class="container">
                <section class="left-side">
                    <section class="items">
                        <section class="select-image" id="select-image">
                            <img src="../imagens/produto_1.avif" alt="Imagem do produto Moletom Capuz Graphic">
                        </section>
                    </section>
                    <section class="produto">
                        <section class="info-produto">
                            <h2 class="nome-produto">MOLETOM CAPUZ GRAPHIC <br> SHMOOFOIL (GÊNERO NEUTRO)</h2>
                            <h2 class="preco-produto">R$549,99</h2>
                            <section id="numeros-calcado">
                                <label class="tamanho">Tamanho:</label><br>
                                <section class="tamanho-calçado">P</section>
                            </section>
                            <button class="comprar">
                                <a href="#" target="_blank" style="color: white;">Comprar</a>
                            </button>
                        </section>
                    </section>
                </section>
            </section>
        </section>
        
        <section class="descricao">
            <h1 class="detalhes">Descrição:</h1>
            <p style="margin-bottom: 50px;">
                A arte icônica de Mark Gonzales mistura a estética urbana que ele viu crescendo em South Gate, Los Angeles, com ilustrações expressivas e muita imaginação. Para o blusão com capuz adidas Skateboarding Shmoofoil Logo, The Gonz apresenta uma versão pintada com spray do clássico personagem Shmoo. A estrutura de fleece médio encorpado significa que ela é feita para skate. Este moletom foi produzido com UNITEFIT, um sistema de ajuste para todos os gêneros criado com base em uma variedade de tamanhos, corpos e formas. 
                Os nossos produtos em algodão apoiam a plantação mais sustentável dessa matéria-prima.
            </p>
        </section>
        
    <h1 class="titulo"><a class="todos">Você</a> pode gostar</h1>
    <section class="produtos">
        
    </section>
    <footer>
        <section class="container-footer">
          <section class="row-footer">
              <!-- Footer col-->
              <section class="footer-col">
                  <h4>Empresa</h4>
                  <ul>
                      <li> <a href=""> Quem Somos</a> 
                      <li> <a href=""> Politíca de privacidade</a> 
                      <li> <a href=""> Agregados/Afiliados </a> 
                  </ul>
                  
              </section>
              
              <!--end footer col-->
              <!-- Footer col-->
              <section class="footer-col">
                  <h4>Obter Ajuda</h4>
                  <ul>
                      <li> <a href=""> Devoluções</a> 
                      <li> <a href=""> Status de pedido </a> 
                      <li> <a href=""> Opções de pagamento  </a> 
                  </ul>
                  
              </section>
              <!--end footer col-->
              <!-- Footer col-->
              <section class="footer-col">
                  <h4>Entre em contato</h4>
                  <ul>
                      <li> <a href=""><i class="fa fa-whatsapp"></i> 551199999-9999</a> 
                      <li> <a href=""> sk8california@gmail.com</a> 
                      <li> <a href=""> Rua sucesso</a> 
                    
                      
                  </ul>
                  
              </section>
              <!--end footer col-->
              <!-- Footer col-->
              <section class="footer-col">
                  <h4>Cadastre-se para mais!</h4>
                  <section class="form-sub">
                      <form>
                        <button><a href="../"> Cadastre-se</a></button>
                      </form>
                  </section>
                  <section class="medias-socias">
                      <a href=""><i class="fa fa-facebook"></i></a>
                      <a href=""><i class="fa fa-instagram"></i></a>
                      <a href=""><i class="fa fa-twitter"></i></a>
                      <a href=""><i class="fa fa-github"></i></a>

                    </section>
              </section>
      </footer>
    </main>
    <script>
        const urlParams = new URLSearchParams(window.location.search);

        // Pega os valores dos parâmetros da URL
        const nome = urlParams.get('nome');
        const nomeProdutoDestaque = urlParams.get('nome'); // Pode pegar isso da URL ou dos dados já carregados
        const preco = urlParams.get('preco');
        const descricao = urlParams.get('descricao');
        const tamanho = urlParams.get('tamanho');
        const imagem = urlParams.get('imagem');  // URL da imagem do produto
        const linkCompra = urlParams.get('link');  // URL de redirecionamento para compra

        // Verifica se os parâmetros estão disponíveis e os preenche
        if (nome) {
            document.querySelector('.nome-produto').textContent = nome;
        }
        if (preco) {
            document.querySelector('.preco-produto').textContent = `R$ ${preco}`;
        }
        if (descricao) {
            document.querySelector('.descricao p').textContent = descricao;
        }
        if (tamanho) {
            // Divide o tamanho em uma lista, separando por vírgulas
            const tamanhos = tamanho.split(',').map(t => t.trim());

            // Cria uma string com várias sections para os tamanhos
            let tamanhoSections = '';
            tamanhos.forEach(tam => {
                tamanhoSections += `<section class="tamanho-calçado">${tam}</section>`;
            });

            // Substitui o conteúdo original com as seções de tamanhos
            const numerosCalcado = document.querySelector('#numeros-calcado');
            numerosCalcado.innerHTML = `
                <label class="tamanho">Tamanho:</label><br>
                ${tamanhoSections}
            `;
        }
        if (imagem) {
            // Atualiza a imagem se o URL estiver presente
            const selectImage = document.querySelector('#select-image img');
            selectImage.src = imagem;
            selectImage.alt = `Imagem do produto ${nome}`;  // Atualiza o atributo alt
        } else {
            console.error('Imagem não fornecida na URL.');
        }

        if (linkCompra) {
            // Atualiza o link do botão de comprar
            const comprarBtn = document.querySelector('.comprar a');
            comprarBtn.href = linkCompra;
            comprarBtn.textContent = 'Comprar Agora';  // Para garantir que o texto está correto
        } else {
            console.error('URL de compra não fornecida na URL.');
        }

        async function carregarProdutosRelacionados(nomeProdutoDestaque) {
        console.log('Carregando produtos relacionados...');
        try {
            const response = await fetch(`http://localhost:3000/produtos-relacionados?nome_produto=${nomeProdutoDestaque}`);
            if (!response.ok) {
                throw new Error('Erro ao buscar os produtos relacionados, status: ' + response.status);
            }

            const data = await response.json();
            console.log('Produtos relacionados recebidos:', data);

            const produtos = data.produtos;
            const produtosContainer = document.querySelector('.produtos'); // Corrigir o seletor

            produtosContainer.innerHTML = ''; // Limpa o container antes de preencher

            produtos.forEach(produto => {
                const imagemUrl = produto.IMAGEM ? `/imagens_produto/${produto.IMAGEM}` : '/imagens/default.jpg';
                const produtoCard = `
                    <section class="produto-card">
                        <img src="${imagemUrl}" alt="${produto.NOME}">
                        <h2><a href="#">${produto.NOME}</a></h2>
                        <p>Marca: ${produto.MARCA}</p>
                        <p class="preco">Preço: R$ ${produto.VALOR}</p>
                        <br>
                        <a href="/buypage?nome=${produto.NOME}&preco=${produto.VALOR}&descricao=${produto.DESCRICAO}&tamanho=${produto.TAMANHO}&imagem=${imagemUrl}&link=${produto.URL_PRODUTO}" class="buy">Compre Agora</a>
                    </section>
                `;
                produtosContainer.innerHTML += produtoCard;
            });
        } catch (error) {
            console.error('Erro ao carregar os produtos relacionados:', error);
        }
    }

    carregarProdutosRelacionados(nomeProdutoDestaque);
    </script>
    
    
    <script src="../js/buy.js"></script>
    <script src="../js/script.js"></script>
</body>
</html>